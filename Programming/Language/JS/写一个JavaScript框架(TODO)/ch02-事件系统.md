
## 使用事件循环

现代框架在后台处理DOM操作和数据绑定，他们批量操作且异步执行，为了让这些任务按正确的时序执行，预想的定时系统：
1. 用户编码，自定义钩子
2. 框架提供数据绑定和响应DOM操作

### 实现事件系统

1. 使用代理注册对象变动实现数据绑定，使用MutationObserver注册DOM变动
2. 用户代码运行结束后，框架注册的微任务开始执行
3. 使用requestAnimationFrame运行用户钩子，相当于vue的nextTick
4. 渲染视图

### 规则

1. 不要在内部操作中使用setTimeout，因为其何时真正执行不可预知
2. 用相同的方法注册微任务，不同的方法会导致执行顺序混乱
3. 不要污染用户的钩子函数执行的时间窗口，这可能会导致不可预知的行为
